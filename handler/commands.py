from aiogram import types
from aiogram.utils.keyboard import InlineKeyboardBuilder

from db.handler.create import create_user
from db.handler.get import get_user_by_tg_id


async def cmd_start(message: types.Message):
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ —Å–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
    if await get_user_by_tg_id(message.from_user.id):
        await create_user(tg_id=message.from_user.id, nickname=message.from_user.username)

    # –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É
    builder = InlineKeyboardBuilder()
    builder.add(types.InlineKeyboardButton(
        text="‚ú® –£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ",
        callback_data="quiz")
    )

    # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    welcome_text = """
<b>üå∏ –ü—Ä–∏–≤–µ—Ç, —è Bloommy!</b>

–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <b>Bloommy</b> ‚Äî –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –º–∞–≥–∞–∑–∏–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ –≤–µ–±-–±–æ—Ç–∞ –¥–ª—è Telegram, —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è <b>—Ü–≤–µ—Ç–æ—á–Ω—ã—Ö –∏ –ø–æ–¥–∞—Ä–æ—á–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤</b>.

–° <b>Bloommy</b> —Ç—ã –º–æ–∂–µ—à—å:
‚úÖ <b>–õ–µ–≥–∫–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å</b> –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–≤–æ–π Telegram-–º–∞–≥–∞–∑–∏–Ω
‚úÖ –°–¥–µ–ª–∞—Ç—å –µ–≥–æ <b>—É–¥–æ–±–Ω—ã–º –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤</b>
‚úÖ <b>–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å</b> –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–¥–∞–∂

<b>üöÄ –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>

üîπ /demo ‚Äî –ø–æ—Å–º–æ—Ç—Ä–∏ <b>–¥–µ–º–æ-–≤–µ—Ä—Å–∏—é</b> –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞
üîπ /info ‚Äî —É–∑–Ω–∞–π <b>–∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å</b> —Å–≤–æ–π –º–∞–≥–∞–∑–∏–Ω
üîπ /tariff ‚Äî –≤—ã–±–µ—Ä–∏ <b>–ø–æ–¥—Ö–æ–¥—è—â–∏–π —Ç–∞—Ä–∏—Ñ–Ω—ã–π –ø–ª–∞–Ω</b>
üîπ /contact ‚Äî <b>—Å–≤—è–∂–∏—Å—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π</b>

<b>Bloommy</b> –¥–µ–ª–∞–µ—Ç —Ç–≤–æ–π –º–∞–≥–∞–∑–∏–Ω –¥–æ—Å—Ç—É–ø–Ω—ã–º –ø—Ä—è–º–æ –≤ Telegram –∏ –ø–æ–º–æ–≥–∞–µ—Ç –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –ø–æ–¥ —Ç–≤–æ–∏ –Ω—É–∂–¥—ã.

<b>‚ö° –ù–∞—á–Ω–∏ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!</b>
"""

    await message.answer(welcome_text, reply_markup=builder.as_markup(), parse_mode="HTML")


async def cmd_demo(message: types.Message):
    # –°–æ–∑–¥–∞–µ–º WebApp –∫–Ω–æ–ø–∫—É
    web_app_info = types.WebAppInfo(
        url="https://demo.bloommy.ru/?action=wptelegram_login_webapp&confirm_login=0&redirect_to=https://demo.bloommy.ru/"
    )

    # –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É
    builder = InlineKeyboardBuilder()
    builder.add(types.InlineKeyboardButton(
        text="üöÄ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–µ–º–æ",  # –î–æ–±–∞–≤–∏–ª–∏ —ç–º–æ–¥–∑–∏ –¥–ª—è –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        web_app=web_app_info)
    )

    # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å HTML-—Ä–∞–∑–º–µ—Ç–∫–æ–π
    demo_text = """
<b>üå∑ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è Bloommy</b>

–ü–æ–∑–Ω–∞–∫–æ–º—å—Å—è —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ –Ω–∞—à–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –≤ <b>–¥–µ–º–æ-—Ä–µ–∂–∏–º–µ</b> –∏ —É–≤–∏–¥–∏—à—å, –∫–∞–∫ –ø—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–π –º–∞–≥–∞–∑–∏–Ω –≤ Telegram!

<b>‚ú® –ß—Ç–æ —Ç—ã —É–≤–∏–¥–∏—à—å –≤ –¥–µ–º–æ-–≤–µ—Ä—Å–∏–∏:</b>

üå∏ <b>–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</b> - –∫—Ä–∞—Å–∏–≤–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –¥–ª—è —Ü–≤–µ—Ç–æ–≤ –∏ –ø–æ–¥–∞—Ä–∫–æ–≤
üõí <b>–ü—Ä–æ—Ü–µ—Å—Å –∑–∞–∫–∞–∑–∞</b> - —É–¥–æ–±–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –ø—Ä—è–º–æ –≤ –±–æ—Ç–µ
‚öôÔ∏è <b>–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</b> - –ø—Ä–æ—Å—Ç—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞

<b>Bloommy</b> –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —Ç–≤–æ–π Telegram-–±–æ—Ç –≤ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ <b>–º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</b> –¥–ª—è –ø—Ä–æ–¥–∞–∂!

–ù–∞–∂–º–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã <b>–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥–µ–º–æ-–≤–µ—Ä—Å–∏—é</b> –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å üëá
"""

    await message.answer(
        demo_text,
        reply_markup=builder.as_markup(),
        parse_mode="HTML"  # –í–∫–ª—é—á–∞–µ–º HTML-—Ä–∞–∑–º–µ—Ç–∫—É
    )


async def cmd_info(message: types.Message):
    # –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É —Å —ç–º–æ–¥–∑–∏
    builder = InlineKeyboardBuilder()
    builder.add(types.InlineKeyboardButton(
        text="üìù –ü—Ä–æ–π—Ç–∏ –æ–ø—Ä–æ—Å",  # –î–æ–±–∞–≤–∏–ª–∏ —ç–º–æ–¥–∑–∏ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –≤—ã–¥–µ–ª–µ–Ω–∏—è
        callback_data="quiz"
    ))

    # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    info_text = """
<b>üåø Bloommy ‚Äî —Ç–≤–æ–π –∏–¥–µ–∞–ª—å–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω –≤ Telegram</b>

<b>üìå –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?</b>

Bloommy ‚Äî —ç—Ç–æ <b>–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä</b> –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ–±-–±–æ—Ç–∞ –≤ Telegram, —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –¥–ª—è <b>—Ü–≤–µ—Ç–æ—á–Ω—ã—Ö –∏ –ø–æ–¥–∞—Ä–æ—á–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤</b>.

<b>üîπ –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:</b>

1. <b>üìû –û–ø—Ä–æ—Å —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º</b>
   –£—Ç–æ—á–Ω–∏–º –≤–∞—à–∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –¥–ª—è –∏–¥–µ–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–∏—Å–∞

2. <b>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞</b>
   –ù–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç:
   ‚Ä¢ –õ–æ–≥–æ—Ç–∏–ø –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ
   ‚Ä¢ –¶–≤–µ—Ç–æ–≤—É—é –≥–∞–º–º—É
   ‚Ä¢ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

3. <b>üÜì –ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥ 7 –¥–Ω–µ–π</b>
   –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫:
   ‚Ä¢ –ö–∞—Ç–∞–ª–æ–≥—É —Ç–æ–≤–∞—Ä–æ–≤
   ‚Ä¢ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
   ‚Ä¢ –í—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º –±–æ—Ç–∞

4. <b>üí≥ –û–ø–ª–∞—Ç–∞ —Ç–∞—Ä–∏—Ñ–∞</b>
   –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø–æ—Å–ª–µ –ø—Ä–æ–±–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞

<b>‚ú® –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Bloommy:</b>
‚Ä¢ –ü—Ä–æ—Å—Ç–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏
‚Ä¢ –£–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤
‚Ä¢ –ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∂

<b>üöÄ –ù–∞—á–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–¥–∞–∂–∏ —É–∂–µ —Å–µ–≥–æ–¥–Ω—è!</b>
"""

    await message.answer(
        info_text,
        reply_markup=builder.as_markup(),
        parse_mode="HTML"  # –í–∫–ª—é—á–∞–µ–º HTML-—Ä–∞–∑–º–µ—Ç–∫—É
    )


async def cmd_tariff(message: types.Message):
    # –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É —Å —ç–º–æ–¥–∑–∏
    builder = InlineKeyboardBuilder()
    builder.add(types.InlineKeyboardButton(
        text="üí≥ –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑",  # –î–æ–±–∞–≤–∏–ª–∏ —ç–º–æ–¥–∑–∏ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –≤—ã–¥–µ–ª–µ–Ω–∏—è
        callback_data="quiz"
    ))

    # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ç–∞—Ä–∏—Ñ–∞—Ö
    tariff_text = """
<b>üíé –¢–∞—Ä–∏—Ñ—ã Bloommy</b>

<b>üåø –ë–∞–∑–æ–≤—ã–π —Ç–∞—Ä–∏—Ñ: 3 000 ‚ÇΩ/–º–µ—Å—è—Ü</b>

–ü–æ–ª–Ω—ã–π –ø–∞–∫–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∞—à–∏–º –º–∞–≥–∞–∑–∏–Ω–æ–º –≤ Telegram.

<b>‚ú® –ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ:</b>

‚úÖ <b>–ü–æ–ª–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞</b>
   ‚Ä¢ –õ–æ–≥–æ—Ç–∏–ø –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ
   ‚Ä¢ –¶–≤–µ—Ç–æ–≤–∞—è –≥–∞–º–º–∞
   ‚Ä¢ –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

‚úÖ <b>–£–¥–æ–±–Ω–∞—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</b>
   ‚Ä¢ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–æ–º —Ç–æ–≤–∞—Ä–æ–≤
   ‚Ä¢ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞
   ‚Ä¢ –ö–æ–Ω—Ç—Ä–æ–ª—å –∑–∞–∫–∞–∑–æ–≤

‚úÖ <b>–ü–æ–ª–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø—Ä–æ–¥–∞–∂</b>
   ‚Ä¢ –ü—Ä–∏–µ–º –∑–∞–∫–∞–∑–æ–≤
   ‚Ä¢ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
   ‚Ä¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

‚úÖ <b>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ 24/7</b>
   ‚Ä¢ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏
   ‚Ä¢ –ü–æ–º–æ—â—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
   ‚Ä¢ –†–µ—à–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–æ–≤

<b>üÜì –ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥ 7 –¥–Ω–µ–π</b> - –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç-–¥—Ä–∞–π–≤ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π!

<b>üíº –£—Å–ª–æ–≤–∏—è:</b>
‚Ä¢ –ï–∂–µ–º–µ—Å—è—á–Ω–∞—è –æ–ø–ª–∞—Ç–∞
‚Ä¢ –ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ
‚Ä¢ –ë–µ–∑ —Å–∫—Ä—ã—Ç—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π

<b>üöÄ –ù–∞—á–Ω–∏ –ø—Ä–æ–¥–∞–≤–∞—Ç—å –≤ Telegram —É–∂–µ —Å–µ–≥–æ–¥–Ω—è!</b>
"""

    await message.answer(
        tariff_text,
        reply_markup=builder.as_markup(),
        parse_mode="HTML"  # –í–∫–ª—é—á–∞–µ–º HTML-—Ä–∞–∑–º–µ—Ç–∫—É
    )

async def cmd_contact(message: types.Message):
    # –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É —Å —ç–º–æ–¥–∑–∏
    builder = InlineKeyboardBuilder()
    builder.add(types.InlineKeyboardButton(
        text="üí¨ –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é",  # –î–æ–±–∞–≤–∏–ª–∏ —ç–º–æ–¥–∑–∏
        callback_data="quiz"
    ))

    # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    contact_text = """
<b>üì© –ö–æ–Ω—Ç–∞–∫—Ç—ã Bloommy</b>

–ú—ã –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –∏ –∑–∞–ø—É—Å–∫–æ–º —Ç–≤–æ–µ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞!

<b>üîπ –°–ø–æ—Å–æ–±—ã —Å–≤—è–∑–∏:</b>

üìû <b>–¢–µ–ª–µ—Ñ–æ–Ω:</b> 
+7 (978) 179-75-78

‚úâÔ∏è <b>Email:</b> 
support@bloommy.ru

üì≤ <b>Telegram:</b> 
@bloommy_support

<b>‚è∞ –ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏:</b>
–ü–Ω-–ü—Ç: 9:00 - 18:00
–°–±-–í—Å: 10:00 - 15:00

<b>üí° –ù—É–∂–Ω–∞ —Å—Ä–æ—á–Ω–∞—è –ø–æ–º–æ—â—å?</b>
–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ üëá
"""

    await message.answer(
        contact_text,
        reply_markup=builder.as_markup(),
        parse_mode="HTML"  # –í–∫–ª—é—á–∞–µ–º HTML-—Ä–∞–∑–º–µ—Ç–∫—É
    )
